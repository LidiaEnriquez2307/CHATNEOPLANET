-- SALA
delimiter //
use CHAT;
//

drop procedure if exists sp_insertar_sala;
//
drop procedure if exists sp_buscar_sala;
//
drop procedure if exists sp_mostrar_salas;
//
drop procedure if exists sp_sala_cuenta;
//

CREATE PROCEDURE sp_insertar_sala
(
    _id_tipo_sala int,
    _Nombre varchar(50)
) 
BEGIN
	INSERT INTO SALA (id_tipo_sala,Nombre) VALUES(_id_tipo_sala,_nombre);
END
//
CREATE PROCEDURE sp_buscar_sala
(
    _nombre text,
    _id_cuenta int
) 
BEGIN
        select s.Nombre as nombre_sala from sala as s INNER JOIN sala_usuario as su on s.id_sala = su.id_sala WHERE su.id_cuenta=_id_cuenta AND s.Nombre LIKE '%_nombre%';
END
//
CREATE PROCEDURE sp_mostrar_salas
(
  _id_cuenta int
)
BEGIN
	select s.Nombre as nombre_sala from sala as s INNER JOIN sala_usuario as su on s.id_sala = su.id_sala WHERE su.id_cuenta=_id_cuenta;
END
//
CREATE PROCEDURE sp_sala_cuenta
(
    _id_cuenta int,
    _id_sala int
) 
BEGIN
	INSERT INTO SALA_CUENTA(id_cuenta,id_sala) VALUES(_id_cuenta,_id_sala);
END
//