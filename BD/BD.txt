use neopruebas;

create table tbl_dispositivo
(
    id_dispositivo int auto_increment primary key not null,
    codigo_unico text not null UNIQUE,
    token text not null UNIQUE,
    id_cuenta int not null,
	foreign key(id_cuenta) references tbl_cuenta(id_cuenta)
);
create table tbl_tipo_sala
(
    id_tipo_sala int primary key not null,
    nombre varchar(10) not null,
    fecha datetime not null,
    activo bool not null
);
create table tbl_sala
(
    id_sala int auto_increment primary key not null,
    id_tipo_sala int not null,
	foreign key(id_tipo_sala) references tbl_tipo_sala(id_tipo_sala),
    nombre varchar(255),
    fecha datetime not null,
    activo bool not null
);
create table tbl_mensaje
(
    id_mensaje int auto_increment primary key not null,
    id_cuenta int not null,
    id_sala int not null,
	foreign key(id_cuenta) references tbl_cuenta(id_cuenta),
	foreign key(id_sala) references tbl_sala(id_sala),
    mensaje text not null,
    fecha datetime not null,
    activo bool not null,
    leido bool not null
);
create table tbl_sala_cuenta
(
    id_sala_cuenta int auto_increment primary key not null,
    id_cuenta int not null,
    id_sala int not null,
	foreign key(id_cuenta) references tbl_cuenta(id_cuenta),
	foreign key(id_sala) references tbl_sala(id_sala),
    administrador bool not null,
    fecha datetime not null,
    activo bool not null
);
create table tbl_ultimo_mensaje_no_visible
(
   id_umnv int auto_increment primary key not null,
   id_cuenta int not null,
   id_sala int not null,
   id_mensaje int not null,
	foreign key(id_cuenta) references tbl_cuenta(id_cuenta),
	foreign key(id_sala) references tbl_sala(id_sala),
	foreign key(id_mensaje) references tbl_mensaje(id_mensaje),
   fecha datetime not null
);